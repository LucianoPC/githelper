#!/usr/bin/env ruby

require 'bundler/setup'
require 'githelper'
require 'option_branch'

VALID_OPTIONS = %w(branch merged).freeze

def usage
  puts 'Usage: gith [option]'
  puts "\n[options]"
  puts ' branch'
  puts ' merged'

  abort
end

def branch
  OptionBranch.run(ARGV)
end

def merged
  base_branch_name = 'master' if ARGV.count < 2
  base_branch_name ||= ARGV[1]

  merged_branchs = Githelper.all_merged(base_branch_name)
  merged_branchs.each { |branch_name| puts branch_name }
end

def main
  usage if ARGV.count == 0 || !VALID_OPTIONS.include?(ARGV[0])

  option = ARGV[0]
  send(option.to_s)
end

main
